#!/bin/sh -x


if [ -n "$SSH_CLIENT" ]
then
  nvim $*
  exit 0
fi

if ! pgrep "nvim"
then
  nohup nvim --headless >/dev/null 2>&1 &
fi

pgrep "neovide"

NEOVIDE_INSTANCE_NOT_RUNNING="$?"

if [ $NEOVIDE_INSTANCE_NOT_RUNNING = "1" ]
then
  nohup neovide --remote-tcp=localhost:6666 --multigrid --frame None >/dev/null 2>&1 &
fi

nvr --servername localhost:6666 $*

if [ -z "$SSH_CLIENT" ]
then
	wmctrl -a Neovide
fi
