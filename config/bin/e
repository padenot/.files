#!/bin/sh -x


if [ -n "$SSH_CLIENT" ]
then
  nvim $*
fi

if ! pgrep "nvim --headless"
then
  nohup nvim --headless >/dev/null 2>&1 &
fi

pgrep "neovide"

NEOVIDE_INSTANCE_NOT_RUNNING="$?"

if [ $NEOVIDE_INSTANCE_NOT_RUNNING = "1" ]
then
  nohup neovide --remote-tcp=localhost:6666 --multiGrid >/dev/null 2>&1 &
fi

nvr --servername localhost:6666 $*

# this shouldn't be necessary but is
nvr -c ':colorscheme solarized8'

if [ -z "$SSH_CLIENT" ]
then
	wmctrl -a Neovide
fi
